#!/usr/bin/env sh

# Configuration
OUTPUT_DIR="$HOME/Videos/$(date +"Video_%Y-%m-%d_%I-%M-%p.mp4")"
FPS=60
VIDEO_QUALITY="ultra"
AUDIO_SINK="default_output"
RECORD_MODE="screen"

# Start GPU Screen Recorder
gpu-screen-recorder -w "$RECORD_MODE" -f "$FPS" -q "$VIDEO_QUALITY" -a "$AUDIO_SINK" -o "$OUTPUT_DIR" &
RECORDER_PID=$!

notify-send -a "GPU Screen Recorder" --icon=com.dec05eba.gpu_screen_recorder "Started gameplay recording"

# Start game
"$@"

# Stop recording
kill "$RECORDER_PID"
wait "$RECORDER_PID"

notify-send -a "GPU Screen Recorder" --icon=com.dec05eba.gpu_screen_recorder "Stopped gameplay recording" "Video saved to $OUTPUT_DIR"
